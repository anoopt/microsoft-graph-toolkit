<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>Microsoft Graph Toolkit Test</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css" rel="stylesheet" />
    <!-- <script src="./node_modules/@webcomponents/webcomponentsjs/webcomponents-loader.js"></script> -->

    <script src="https://unpkg.com/@microsoft/teams-js@2/dist/MicrosoftTeams.min.js" crossorigin="anonymous"></script>

    <!-- <script src="./packages/mgt/dist/bundle/mgt-loader.js"></script> -->
    <script type="module" src="https://unpkg.com/@fluentui/web-components"></script>

    <script type="module" src="./packages/mgt/dist/es6/index.js"></script>

    <style>
      .app {
        margin: 16px;
      }

      #search-input {
        width: 100%;
      }
    </style>
  </head>

  <body>
    <!-- <mgt-teams-provider
      client-id="a974dfa0-9f57-49b9-95db-90f04ce2111a"
      auth-popup-url="auth.html"
    ></mgt-teams-provider> -->

    <!-- <mgt-teams-msal2-provider
      client-id="72482bff-ecae-44f5-8fdc-513b7f5602e7"
      scopes="user.read,user.read.all,mail.readBasic,people.read,people.read.all,sites.read.all,user.readbasic.all,contacts.read,presence.read,presence.read.all,tasks.readwrite,tasks.read,calendars.read,group.read.all"
      auth-popup-url="auth.html"
    ></mgt-teams-msal2-provider> -->

    <!-- Teams Msal2 provider in SSO mode (see "teams-sso-node" sample) -->
    <!-- <mgt-teams-msal2-provider
      client-id="72482bff-ecae-44f5-8fdc-513b7f5602e7"
      scopes="user.read,user.read.all,mail.readBasic,people.read,people.read.all,sites.read.all,user.readbasic.all,contacts.read,presence.read,presence.read.all,tasks.readwrite,tasks.read,calendars.read,group.read.all"
      auth-popup-url="auth.html"
      sso-url="http://localhost:5000/api/token"
      http-method="POST"
    ></mgt-teams-msal2-provider> -->

    <!-- <mgt-msal-provider
      client-id="a974dfa0-9f57-49b9-95db-90f04ce2111a"
      scopes="user.read,user.read.all,mail.readBasic,people.read,people.read.all,sites.read.all,user.readbasic.all,contacts.read,presence.read,presence.read.all,tasks.readwrite,tasks.read,calendars.read,group.read.all"
      redirect-uri="http://localhost:3000"
      depends-on="mgt-teams-provider"
    ></mgt-msal-provider> -->

    <mgt-msal2-provider
      client-id="2dfea037-938a-4ed8-9b35-c05708a1b241"
      redirect-uri="http://localhost:3000"
      scopes="user.read,user.read.all,mail.read,people.read,people.read.all,sites.read.all,user.readbasic.all,contacts.read,presence.read,presence.read.all,tasks.readwrite,tasks.read,calendars.read,group.read.all,files.read,files.read.all,files.readwrite,files.readwrite.all"
    ></mgt-msal2-provider>

    <main class="app">
      <h1>Search Center</h1>
      <mgt-login></mgt-login>
      <!--h2>mgt-person me query two lines card on click with presence</h2>
      <mgt-person person-query="me" view="twoLines" person-card="click" show-presence></mgt-person>
      <h2>mgt-people-picker</h2>
      <mgt-people-picker></mgt-people-picker>
      <h2>mgt-teams-channel-picker</h2>
      <mgt-teams-channel-picker></mgt-teams-channel-picker>
      <h2>mgt-tasks</h2>
      <mgt-tasks></mgt-tasks>
      <h2>mgt-agenda group-by-day</h2>
      <mgt-agenda group-by-day></mgt-agenda>
      <h2>mgt-people show-presence</h2>
      <mgt-people show-presence></mgt-people>
      <h2>mgt-todo</h2>
      <mgt-todo></mgt-todo>
      <h2>mgt-file-list</h2>
      <mgt-file-list></mgt-file-list>
      <h2>mgt-search</h2-->
      <fluent-search
        id="search-input"
        appearance="outline"
        autofocus
        placeholder="Search"
        onChange="onSearchInputChanged()"
      >
      </fluent-search>

      <fluent-tabs id="search-tab" activeId="tab-all" orientation="horizontal">
        <fluent-tab id="tab-all">All</fluent-tab>
        <fluent-tab id="tab-files">Files</fluent-tab>
        <fluent-tab id="tab-sites">Sites</fluent-tab>
        <fluent-tab id="tab-people" onclick="alert('test')">People</fluent-tab>
        <fluent-tab-panel id="tab-panel-all">
          <mgt-search-results entity-types="list,site,drive,driveItem,listItem" fetch-thumbnail="true">
          </mgt-search-results>
        </fluent-tab-panel>
        <fluent-tab-panel id="tab-panel-files">
          <mgt-search-results entity-types="driveItem" fetch-thumbnail="true"> </mgt-search-results>
        </fluent-tab-panel>
        <fluent-tab-panel id="tab-panel-sites">
          <mgt-search-results entity-types="site"> </mgt-search-results>
        </fluent-tab-panel>
        <fluent-tab-panel id="tab-panel-people">
          <mgt-search-results version="beta" entity-types="people" size="20"> </mgt-search-results>
        </fluent-tab-panel>
        <div>Testing</div>
      </fluent-tabs>
    </main>

    <script>
      function onSearchInputChanged() {
        const searchInput = document.getElementById("search-input");
        const searchResults = [...document.querySelectorAll("mgt-search-results")];

        searchResults.map((result) => {
          result.queryString = searchInput.value;
        });
      }

      const searchInput = document.getElementById("search-input");

      searchInput.addEventListener(
          "keyup",
          debounce(() => {
            const searchResults = [...document.querySelectorAll("mgt-search-results")];
            searchResults.map((result) => {
              result.queryString = searchInput.value;
            });
          }, 400)
      );

      function debounce( callback, delay ) {
          let timeout;
          return function() {
              clearTimeout( timeout );
              timeout = setTimeout( callback, delay );
          }
      }
    </script>
  </body>
</html>
